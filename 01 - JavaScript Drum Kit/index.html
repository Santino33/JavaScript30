<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Javascript Drum Kit</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    
    <div class="" id="main-container">
        <div data-key="65" class="key">
            <p>A</p>
            <span class="sound">CLAP</span>
        </div>
        <div data-key="83" class="key">
            <p>S</p>
            <span class="sound">HIHAT</span>
        </div>
        <div data-key="68" class="key">
            <p>D</p>
            <span class="sound">KICK</span>
        </div>
        <div data-key="70" class="key">
            <p>F</p>
            <span class="sound">OPENHAT</span>
        </div>
        <div data-key="71" class="key">
            <p>G</p>
            <span class="sound">BOOM</span>
        </div>
        <div data-key="72" class="key">
            <p>H</p>
            <span class="sound">RIDE</span>
        </div>
        <div data-key="74" class="key">
            <p>J</p>
            <span class="sound">SNARE</span>
        </div>
        <div data-key="75" class="key">
            <p>K</p>
            <span class="sound">TOM</span>
        </div>
        <div data-key="76" class="key">
            <p>L</p>
            <span class="sound">TINK</span>
        </div>
    </div>

    <audio data-key="65" src="sounds/clap.wav"></audio>
    <audio data-key="83" src="sounds/hihat.wav"></audio>
    <audio data-key="68" src="sounds/kick.wav"></audio>
    <audio data-key="70" src="sounds/openhat.wav"></audio>
    <audio data-key="71" src="sounds/boom.wav"></audio>
    <audio data-key="72" src="sounds/ride.wav"></audio>
    <audio data-key="74" src="sounds/snare.wav"></audio>
    <audio data-key="75" src="sounds/tom.wav"></audio>
    <audio data-key="76" src="sounds/tink.wav"></audio>


    <script>
        function addTransition(e){
            const audio = document.querySelector(`audio[data-key="${e.keyCode}"]`);
            const key = document.querySelector(`.key[data-key="${e.keyCode}"]`);
            console.log(audio);
            console.log(key);
            if(!audio) return;
            audio.currentTime = 0;  // reset audio to start position for each key press.  Without this, audio would continue playing from the last played position.  This will ensure that each key press starts the audio from the beginning.  Also, this will prevent the audio from playing multiple instances simultaneously.
            audio.play()
            key.classList.add('playing'); 
        }

        //funcion para remover transicion
        function removeTransition(e){
            if(e.propertyName !== 'transform')
            this.classList.remove('playing');
        }

        window.addEventListener('keydown', addTransition);
        //aÃ±adir evento transitioned a todos los keys
        const keys = document.querySelectorAll('.key');
        keys.forEach(key => key.addEventListener('transitionend', removeTransition));
    </script>
</body>
</html>